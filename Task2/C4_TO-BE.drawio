<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/29.2.9 Chrome/140.0.7339.249 Electron/38.7.2 Safari/537.36" version="29.2.9">
  <diagram id="PbD-Architecture-Final" name="Target Architecture (Connected)">
    <mxGraphModel dx="1098" dy="849" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="zone_dmz" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;verticalAlign=top;align=left;spacingLeft=10;dashed=1;" value="DMZ (Public Access)" vertex="1">
          <mxGeometry height="120" width="1880" x="40" y="160" as="geometry" />
        </mxCell>
        <mxCell id="zone_app" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;verticalAlign=top;align=left;spacingLeft=10;dashed=1;" value="PRIVATE APP ZONE (No Direct Internet Access)" vertex="1">
          <mxGeometry height="480" width="1310" x="40" y="300" as="geometry" />
        </mxCell>
        <mxCell id="zone_analytics" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;verticalAlign=top;align=left;spacingLeft=10;dashed=1;" value="ANALYTICS ZONE (Data Lake)" vertex="1">
          <mxGeometry height="480" width="460" x="1460" y="310" as="geometry" />
        </mxCell>
        <mxCell id="act_patient" parent="1" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" value="Пациент" vertex="1">
          <mxGeometry height="60" width="30" x="80" y="40" as="geometry" />
        </mxCell>
        <mxCell id="act_doc" parent="1" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" value="Врач" vertex="1">
          <mxGeometry height="60" width="30" x="500" y="40" as="geometry" />
        </mxCell>
        <mxCell id="act_lab" parent="1" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" value="Внешняя&lt;br&gt;Лаборатория" vertex="1">
          <mxGeometry height="60" width="30" x="840" y="40" as="geometry" />
        </mxCell>
        <mxCell id="api_gw" parent="1" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1" value="API Gateway&lt;br&gt;(WAF, Rate Limit, TLS)" vertex="1">
          <mxGeometry height="60" width="256" x="490" y="200" as="geometry" />
        </mxCell>
        <mxCell id="sec_iam" parent="1" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" value="IAM / IdP&lt;br&gt;(Keycloak)" vertex="1">
          <mxGeometry height="60" width="140" x="60" y="340" as="geometry" />
        </mxCell>
        <mxCell id="sec_vault" parent="1" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" value="Secrets Vault&lt;br&gt;(HashiCorp)" vertex="1">
          <mxGeometry height="60" width="120" x="220" y="340" as="geometry" />
        </mxCell>
        <mxCell id="sec_token" parent="1" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" value="Tokenization Service&lt;br&gt;(PII Isolation)" vertex="1">
          <mxGeometry height="60" width="160" x="800" y="340" as="geometry" />
        </mxCell>
        <mxCell id="sec_consent" parent="1" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" value="Consent Mgmt&lt;br&gt;(Управление согласиями)" vertex="1">
          <mxGeometry height="60" width="160" x="1110" y="340" as="geometry" />
        </mxCell>
        <mxCell id="svc_emr" parent="1" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="EMR Service&lt;br&gt;(Медкарты)" vertex="1">
          <mxGeometry height="60" width="120" x="140" y="480" as="geometry" />
        </mxCell>
        <mxCell id="svc_appt" parent="1" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="Booking Service&lt;br&gt;(Запись)" vertex="1">
          <mxGeometry height="60" width="120" x="646" y="480" as="geometry" />
        </mxCell>
        <mxCell id="svc_lab" parent="1" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="Lab Integration&lt;br&gt;Service" vertex="1">
          <mxGeometry height="60" width="120" x="1150" y="480" as="geometry" />
        </mxCell>
        <mxCell id="db_pii" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#f8cecc;strokeColor=#b85450;" value="PII DB&lt;br&gt;(Encrypted)" vertex="1">
          <mxGeometry height="80" width="80" x="840" y="680" as="geometry" />
        </mxCell>
        <mxCell id="db_med" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="Medical DB&lt;br&gt;(No PII, UUID Only)" vertex="1">
          <mxGeometry height="80" width="90" x="500" y="660" as="geometry" />
        </mxCell>
        <mxCell id="db_s3" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="Object Storage&lt;br&gt;(Files + S3 Encryption)" vertex="1">
          <mxGeometry height="80" width="100" x="1040" y="660" as="geometry" />
        </mxCell>
        <mxCell id="etl" parent="1" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1" value="ETL / Anonymizer&lt;br&gt;(Data Masking)" vertex="1">
          <mxGeometry height="60" width="140" x="1480" y="490" as="geometry" />
        </mxCell>
        <mxCell id="dwh" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#d5e8d4;strokeColor=#82b366;" value="Data Warehouse&lt;br&gt;(Anonymized)" vertex="1">
          <mxGeometry height="80" width="140" x="1730" y="480" as="geometry" />
        </mxCell>
        <mxCell id="bi_tool" parent="1" style="shape=rect;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" value="BI / ML Tools&lt;br&gt;(Jupyter/Superset)" vertex="1">
          <mxGeometry height="60" width="140" x="1730" y="200" as="geometry" />
        </mxCell>
        <mxCell id="audit_log" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#e1d5e7;strokeColor=#9673a6;" value="Audit Log&lt;br&gt;(ELK)" vertex="1">
          <mxGeometry height="80" width="80" x="90" y="660" as="geometry" />
        </mxCell>
        <mxCell id="c1" edge="1" parent="1" source="act_patient" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;" target="api_gw" value="HTTPS">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c_doc" edge="1" parent="1" source="act_doc" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.75;entryY=0;" target="api_gw" value="HTTPS">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c_lab_ext" edge="1" parent="1" source="act_lab" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.898;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" target="api_gw" value="Webhook">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c2" edge="1" parent="1" source="api_gw" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;" target="sec_iam" value="Auth">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="130" y="230" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c3" edge="1" parent="1" source="api_gw" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;" target="sec_token" value="Get UUID">
          <mxGeometry relative="1" x="0.4" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c4" edge="1" parent="1" source="api_gw" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;exitX=1;exitY=0.75;exitDx=0;exitDy=0;" target="sec_consent" value="Check Consent">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1190" y="245" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c_route_emr" edge="1" parent="1" source="api_gw" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" target="svc_emr" value="View Record">
          <mxGeometry relative="1" x="0.2121" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="440" y="440" />
              <mxPoint x="180" y="440" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c_route_book" edge="1" parent="1" source="api_gw" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;exitX=0.846;exitY=0.994;exitDx=0;exitDy=0;exitPerimeter=0;" target="svc_appt" value="Book">
          <mxGeometry relative="1" x="0.36" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="706" y="320" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c_route_lab" edge="1" parent="1" source="api_gw" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;exitX=0.635;exitY=0.983;exitDx=0;exitDy=0;exitPerimeter=0;" target="svc_lab" value="Save Result">
          <mxGeometry relative="1" x="0.561" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="650" y="259" />
              <mxPoint x="650" y="460" />
              <mxPoint x="1210" y="460" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c_vault_1" edge="1" parent="1" source="svc_emr" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=1;dashed=1;fontColor=#999999;exitX=1;exitY=0.25;exitDx=0;exitDy=0;" target="sec_vault" value="Get Creds">
          <mxGeometry relative="1" x="0.619" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="280" y="495" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c_vault_2" edge="1" parent="1" source="svc_appt" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=1;entryY=0.5;dashed=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;entryDx=0;entryDy=0;" target="sec_vault" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="676" y="370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c_pii_store" edge="1" parent="1" source="sec_token" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;" target="db_pii" value="UUID Map">
          <mxGeometry relative="1" x="0.3103" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c_emr_read" edge="1" parent="1" source="svc_emr" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;" target="db_med" value="Read/Write">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c_book_save" edge="1" parent="1" source="svc_appt" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=1;entryY=0;" target="db_med" value="Save Appt">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c_lab_s3" edge="1" parent="1" source="svc_lab" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=1;entryY=0.5;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryDx=0;entryDy=0;entryPerimeter=0;" target="db_s3" value="Upload PDF">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c_lab_meta" edge="1" parent="1" source="svc_lab" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=1;entryY=0;entryDx=0;entryDy=52.5;entryPerimeter=0;" target="db_med" value="Meta">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="790" y="510" />
              <mxPoint x="790" y="713" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c_emr_s3" edge="1" parent="1" source="svc_emr" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.75;exitY=1;exitDx=0;exitDy=0;" target="db_s3" value="View Scan">
          <mxGeometry relative="1" x="-0.6735" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="230" y="600" />
              <mxPoint x="1090" y="600" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c_repl" edge="1" parent="1" source="db_med" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=1;exitY=0;exitDx=0;exitDy=27.5;exitPerimeter=0;" target="etl" value="CDC / Replication">
          <mxGeometry relative="1" x="-0.1429" as="geometry">
            <mxPoint x="1" as="offset" />
            <Array as="points">
              <mxPoint x="590" y="690" />
              <mxPoint x="680" y="690" />
              <mxPoint x="680" y="620" />
              <mxPoint x="1550" y="620" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="c_etl" edge="1" parent="1" source="etl" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0;entryY=0.5;" target="dwh" value="Clean Data">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c_bi" edge="1" parent="1" source="bi_tool" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;" target="dwh" value="SQL Query">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c_analyst" edge="1" parent="1" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;" target="bi_tool" value="Access">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="c_logs" edge="1" parent="1" source="sec_iam" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0.5;entryY=0;dashed=1;" target="audit_log" value="Logs">
          <mxGeometry relative="1" x="0.4615" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="iR6ULXjsjPLk6-Ny0ikv-2" edge="1" parent="1" source="iR6ULXjsjPLk6-Ny0ikv-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="bi_tool">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="iR6ULXjsjPLk6-Ny0ikv-3" connectable="0" parent="iR6ULXjsjPLk6-Ny0ikv-2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Work (VPN)" vertex="1">
          <mxGeometry relative="1" x="-0.125" y="3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="iR6ULXjsjPLk6-Ny0ikv-1" parent="1" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" value="Data Scientist" vertex="1">
          <mxGeometry height="60" width="30" x="1570" y="50" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
